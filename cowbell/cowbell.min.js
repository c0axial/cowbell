window.Cowbell={UI:{},Player:{},Common:{}};window.Cowbell.createPlayer=function(c,d){d||(d={});"string"==typeof c&&(c=document.getElementById(c));var g=new (d.ui||Cowbell.UI.Basic)(c);if(d.player){var b=new d.player(d.playerOpts);d.url&&(b=new b.Track(d.url,d.trackOpts),g.open(b))}return g};window.jQuery&&(window.jQuery.fn.cowbell=function(c){this.each(function(){Cowbell.createPlayer(this,c)})});Cowbell.UI.Basic=function(c){function d(){e.max=100*b.duration}function g(){b=h.open();b.readyState>=b.HAVE_METADATA?d():b.onloadedmetadata=d;b.onplay=function(){f.innerHTML="pause";f.disabled=!1;e.disabled=!1};b.onpause=function(){f.innerHTML="play"};b.ontimeupdate=function(){b&&(e.value=100*b.currentTime)};b.onended=function(){e.value=0;e.disabled=!0}}var b=null,h=null,f=document.createElement("button");f.innerHTML="play";f.disabled=!0;c.appendChild(f);var e=document.createElement("input");e.type=
"range";e.min=0;e.value=0;e.disabled=!0;c.appendChild(e);e.onchange=function(){b.currentTime=e.value/100};f.onclick=function(){b||g();b.paused?(f.disabled=!0,b.play()):b.pause()};this.open=function(c){b&&!b.paused&&b.pause();h&&h.close&&h.close();h=c;b=null;e.value=0;e.disabled=!0;f.disabled=!1}};Cowbell.Player.Audio=function(){this.Track=function(c){this.open=function(){var d=document.createElement("audio");d.src=c;document.body.appendChild(d);return d}}};(function(){var c;Cowbell.Common.WebAudioPlayer=function(d,g){this.Track=function(b,h){var f;this.open=function(){function e(b){k&&k.disconnect(0);f.seek(b);l=b;m=!1;k=c.createScriptProcessor(s,0,f.channelCount);k.onaudioprocess=r;a.paused||(a.paused=!0,a.play())}function r(b){m||(n=b.playbackTime,m=!0);var c=f.generateAudio(b.outputBuffer);if(c<b.outputBuffer.length){for(var d=0;d<b.outputBuffer.numberOfChannels;d++)for(var h=b.outputBuffer.getChannelData(d),g=c;g<b.outputBuffer.length;g++)h[g]=
0;if(a.currentTime>a.duration){a.pause();if(a.onended)a.onended();e(0)}}if(a.ontimeupdate)a.ontimeupdate()}var a={};c||(c=new AudioContext);var s=4096;a.HAVE_NOTHING=0;a.HAVE_METADATA=1;a.HAVE_CURRENT_DATA=2;a.HAVE_FUTURE_DATA=3;a.HAVE_ENOUGH_DATA=4;a.readyState=a.HAVE_NOTHING;f=new d(b,c,g,h);var p=!1,q=!1,k,m=!1,l=0,n;a.paused=!0;f.load(function(){p=!0;a.readyState=a.HAVE_ENOUGH_DATA;a.duration=f.duration;e(0);if(a.onloadedmetadata)a.onloadedmetadata();q&&a.play()});a.play=function(){if(p){if(a.paused){k.connect(c.destination);
a.paused=!1;if(a.onplay)a.onplay();m&&(n=c.currentTime,l=pausedAtTrackTime)}}else q=!0};a.pause=function(){if(!a.paused&&(pausedAtTimestamp=c.currentTime,pausedAtTrackTime=a.currentTime,k.disconnect(0),a.paused=!0,a.onpause))a.onpause()};a.__defineGetter__("currentTime",function(){return!m?l:a.paused?pausedTrackTime:c.currentTime<n?l:l+c.currentTime-n});a.__defineSetter__("currentTime",function(a){e(a)});return a};this.close=function(){f.cleanup&&f.cleanup()}}}})();
